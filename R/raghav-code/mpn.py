import urllib.parse
from datetime import datetime
from typing import TextIO
from selenium import webdriver
import time
import sys
from selenium. webdriver. common. keys import Keys
from selenium.webdriver.chrome.options import Options
from bs4 import BeautifulSoup
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
import selenium.webdriver.remote.webelement


def get_details(url):
    global d
    #current_date: object = datetime.now()
    #save_details: TextIO = open("Destacoo.txt", "a+")
    #save_details.write("\nScrapping Started at : " + current_date.strftime("%B %d, %Y - %H:%M:%S") + "\n")
    #save_details.close()
    #print("\nScrapping Started at : " + current_date.strftime("%B %d, %Y - %H:%M:%S") + "\n")

    print("Please wait. Program will work in background.\n")

    opts = Options()

    opts.add_argument("user-agent=""")
    d = webdriver.Chrome("C:/chromedriver.exe", chrome_options=opts)
    d.implicitly_wait(10)
    d.get(url)
    time.sleep(5)
    title=brand=image=price=bread_=""







    try:
                d.find_element_by_xpath("//*[@id='gcom__typeahead-form']/div/input").click()

                inputElement = d.find_element_by_xpath("//*[@id='gcom__typeahead-form']/div/input")


                inputElement.send_keys(list[x])
                inputElement.send_keys(Keys.ENTER)
                time.sleep(5)


    except:
                pass


    try:
        title=d.find_element_by_xpath("/html/body/main/div/div/div[2]/div/div[3]/div[2]/div[1]/div[1]/div[4]/div[2]/h1").text
        print("product name:"+title)
    except:
        return
    try:
        desc=[]
        abc=d.find_elements_by_class_name("product-detail__product-identifiers-description")
        for a in abc:
            desc.append(a.text)

    except:
        pass
    print("--check--")

    try:
        brand=d.find_element_by_xpath("/html/body/main/div/div/div[2]/div/div[3]/div[2]/div[1]/div[1]/div[4]/div[1]/p/a").text
        print("Brand:"+brand)
    except:
        pass
    try:
        image=d.find_element_by_xpath("//*[@id='enhanced-content__carousel-zoom-image']/div/img").get_attribute("src")
        print("Image : "+image)
    except:
        pass
    try:
        price=d.find_element_by_xpath("/html/body/main/div/div/div[2]/div/div[3]/div[2]/div[2]/div[1]/div[1]/div[2]/div/div[1]/span[2]").text
        print("Price:"+price)
    except:
        pass
    try:
        bread=[]
        crumb=d.find_elements_by_class_name("breadcrumb__link")
        for b in crumb:
            bread.append(b.text)

    except:
        pass
    print("--check--")
    try:
        bread_=d.find_element_by_xpath("/html/body/main/div/div/div[2]/div/div[3]/div[1]/div[1]/nav/ul/li[6]/span[1]").text
        print(bread_)
    except:
        pass

    try:
        prod = d.find_elements_by_class_name("specifications__description")
        print(len(prod))

        specs = d.find_elements_by_class_name("specifications__value")

        i = 0


        while i < len(prod):

            j = 0

            while j < len(specs):
                z = (prod[i].text if prod else "not given")
                print(z)

                i += 1

                xx = (specs[j].text if specs else "not given")
                print(xx)

                j += 1

                save_details: TextIO = open("mpn-456.txt", "a+", encoding="utf-8")
                save_details.write("\n"+title+"\t"+desc[4]+"\t"+desc[5]+"\t"+desc[6]+"\t"+brand+"\t"+image+"\t"+price+"\t"+'/'.join(bread)+"/"+bread_+"\t"+z+"\t"+xx)
                save_details.close()
                print("\n**Record stored into txt file.**")
    except:
        pass



































if __name__ == '__main__':
     url="https://www.grainger.com/"
     list =['00-836939',
'00-851373',
'716940',
'8069-004',
'T 01A 126',
'28705',
'40107',
'40125-T',
'40125',
'40125-100',
'40125T',
'40129',
'40132',
'40131',
'40130',
'GL-2002',
'GL-1001',
'GL-2001',
'GL-1002',
'SLFAS1SS',
'FF21180',
'KN10-6F-D',
'KN10-10R-D',
'1316',
'B535ZN',
'B501-8ZN',
'B501-6ZN',
'B501-5ZN',
'B501-4ZN',
'B501-3ZN',
'B501-3/4ZN',
'B501-31/2ZN',
'B501-2ZN',
'B501-2 1/2ZN',
'SLFAS1',
'SLFASDS1SS',
'SLFASDS1',
'1867-P',
'14983-P',
'1040-P',
'LS/59330',
'LS/22170',
'12765A',
'17130SS',
'14766',
'12766',
'13766',
'17130',
'3886-P',
'170-P',
'716755',
'716535',
'00-855597-00002',
'00-497565-00001',
'00-428035-00001',
'00-424035-00001',
'AE20-2685-3',
'72082',
'72040',
'72081',
'72084',
'72083',
'AE20-2684-3',
'LTC0381000',
'LTCES01B-C',
'SLFSD114',
'SLFSDET114U',
'SLFSDET114',
'SLFETM20114U',
'SLFETM20114',
'SLFSDDS114',
'M20017',
'SC228ZN',
'FIG 98B-EG',
'0453',
'0469',
'0455',
'S018',
'TX-133-8RB-OT',
'TX-133-8RB',
'TX-133-6RB-OT',
'TX-133-6RB',
'TX-133-11RB-OT',
'TX-133-11RB',
'9001-297-9',
'9001-297-24',
'9001-297-18',
'9001-297-12',
'5001-TM',
'5000-TM',
'2011C',
'2011-18C',
'2011-18',
'2011-12C',
'2011-12',
'1512-24',
'1512-18',
'1512-12',
'2011',
'1512',
'961512',
'11313',
'11309',
'11305',
'11302',
'391',
'354',
'152D',
'513-W',
'531-S',
'532-S',
'00-853253',
'00-853309',
'00-853489',
'00-854304-00025',
'716461',
'853985',
'SC-047-17',
'SC-055-02',
'SC-113-83',
'SC-123-65',
'00-413265-00001',
'00-417861-00001',
'713728',
'718304',
'719261',
'719879',
'770205',
'770422',
'TX-CHRK-06',
'TX-21025',
'TX-21005',
'PA20-09',
'PA12-06',
'P-054187',
'P-050934',
'C-083539',
'LS/25030',
'LS/23700',
'ER3020',
'ER17125',
'ER1510',
'ER1575',
'ER27125',
'ER10125',
'VE30022',
'RR-12-34',
'RR-006-23',
'RR-006-22',
'722778',
'713718',
'00-881982',
'00-857547-00007',
'00-854304-00026',
'00-853244',
'00-840484',
'00-714589',
'ER27150',
'ER15125',
'RS-030-04',
'RS-032-77',
'RS-032-78',
'8002-064',
'8002-086',
'P9010-EG',
'E146-1/2SS6',
'AB102-1/2-EG',
'E146-1/2SS',
'E146-5/8',
'AB102-7/8',
'AB102-5/8EG',
'AB102-5/8',
'AB102-3/8',
'AB102-1/4',
'AB102-1/2',
'E146-5/16',
'E146-3/8',
'E146-1/4',
'E146-1/2',
'HSQN062-EG',
'HSQN031-EG',
'HSQN050-EG',
'HSQN037-EG',
'HSQN025-EG',
'B753-3/8ZN',
'B753-1/2ZN',
'7/8HNZN',
'5/8 HN YZN BOXED',
'5/16HNZN',
'5/16 HN YZN BOXED',
'3/8HNZN',
'3/8 HN YZN BOXED',
'3/8 HN SB BOXED',
'3/4HNZN',
'1HNZN',
'1/4HNZN',
'1/4 HN YZN BOXED',
'1/4 HN NYL BOXED',
'1/2HNZN',
'1/2 HN YZN BOXED',
'12-24 HN YZN BOXED',
'12-24 HN NYL BOXED',
'10243 D',
'10243 C',
'10243 B',
'10243 A',
'10242 D',
'10242 C',
'WSHR,LOCK 3/8 SS6',
'12',
'STN228-11/2ZN',
'15',
'11',
'SLWN5/8ZN',
'SLWN3/8ZN',
'SLWN3/8SS6',
'SLWN1/4ZN',
'SLWN1/4SS6',
'SLWN1/2ZN',
'SLWN1/2SS6',
'SLN38ZN',
'SLN12ZN',
'NW528ZN',
'NUT,HEX 3/8 SS4',
'NUT,HEX 1/4 SS4',
'N621ZN',
'DCN-3/8ZN',
'BN-6',
'BN-4',
'BN1',
'BFVHN5/8',
'BFVHN3/8',
'BFVHN3/4',
'BFVHN1/2',
'BFVHN1',
'BFVATRHN3/8',
'BFVATRHN1/2',
'64961',
'64962',
'64963',
'64964',
'64965',
'64966',
'64967',
'64968',
'64969',
'64970',
'64971',
'64972',
'64973',
'64974',
'64975',
'64976',
'68101',
'68102',
'68103',
'68104',
'68105',
'68106',
'68107',
'68108',
'68109',
'68110',
'68111',
'68112',
'68121',
'68122',
'68123',
'68124',
'68125',
'68126',
'68153',
'68155',
'68156',
'68166',
'68167',
'68169',
'68170',
'68171',
'68172',
'68173',
'68174',
'68175',
'68900',
'68901',
'68902',
'68903',
'68904',
'68905',
'68906',
'68907',
'68908',
'68909',
'68910',
'68911',
'68921',
'68922',
'68923',
'68924',
'68925',
'68926',
'68951',
'68952',
'68953',
'68955',
'68956',
'68963',
'68964',
'68965',
'68966',
'68967',
'68969',
'68970',
'68971',
'68973',
'68975',
'69101',
'69102',
'69103',
'69104',
'69105',
'69106',
'69107',
'69108',
'69109',
'69110',
'69111',
'69112',
'69121',
'69122',
'69123',
'69124',
'69125',
'69126',
'69153',
'69155',
'69156',
'69166',
'69167',
'69169',
'69170',
'69171',
'69172',
'69173',
'69174',
'69175',
'69900',
'69901',
'69902',
'69903',
'69904',
'69905',
'69906',
'69907',
'69908',
'69909',
'69910',
'69911',
'69913',
'69914',
'69916',
'69921',
'69922',
'69923',
'69924',
'69925',
'69926',
'69951',
'69952',
'69953',
'69955',
'69956',
'69963',
'69964',
'69965',
'69966',
'69967',
'69969',
'69970',
'69971',
'69973',
'69975',
'82100',
'82100H',
'82102',
'82103',
'82104',
'82104H',
'82105',
'82106',
'82106H',
'82108',
'82108H',
'82109',
'82110',
'82110H',
'82111',
'82112',
'82112H',
'82113',
'82113H',
'82114',
'82114H',
'82115',
'82116',
'82116H',
'82117',
'82117H',
'82118',
'82118H',
'82119',
'82119H',
'82120',
'82120H',
'82121',
'82121H',
'82122',
'82122H',
'82123',
'82123H',
'82124',
'82124H',
'82126',
'82126H',
'82127',
'82127H',
'82128',
'82128H',
'82129',
'82129H',
'82130',
'82130H',
'82131',
'82131H',
'82132',
'82132H',
'82133',
'82133H',
'82134',
'82134H',
'82135',
'82135H',
'82136',
'82136H',
'82137',
'82137H',
'82138',
'82138H',
'82139',
'82139H',
'82140',
'82140H',
'82141',
'82141H',
'82142',
'82142H',
'82143',
'82143H',
'B501-1ZN',
'B501-1/2ZN',
'B501-11/4ZN',
'B501-11/2ZN',
'B500-5ZN',
'B500-5SS4',
'B500-33/8ZN',
'B500-33/8SS4',
'BFV501-4',
'BFV501-3/4',
'BFV501-3',
'BFV501-21/2',
'BFV501-2',
'BFV501-1/2',
'BFV501-11/4',
'BFV501-11/2',
'BFV501-1',
'82144',
'82144H',
'82145',
'UB1-PA',
'UB1-1/2-PA',
'UB1/2-PA',
'UB10-PA',
'UB2-PA',
'UB2-1/2-PA',
'UB3-PA',
'UB3-1/2-PA',
'UB3/4-PA',
'UB4-PA',
'UB5-PA',
'UB6-PA',
'UB8-PA',
'H115-3EG',
'H115-5EG',
'H115-6SS6',
'H115-1-1/4SS316',
'H115-1EG',
'H115-2EG',
'H115-2SS316',
'82145H',
'82146',
'8005-009',
'8005-016',
'SLFCBDS1',
'SLFCBDS1SS',
'SLFCB58',
'SLFCB34',
'SLFCB1',
'SLFCB1SS',
'503293',
'500315',
'506502',
'506985',
'502819',
'511938',
'512985',
'514333',
'513779',
'500320',
'500326',
'509980',
'82147',
'82150',
'82151',
'82152',
'82153',
'82153H',
'82154',
'82154H',
'82155',
'82155H',
'82156',
'82156H',
'82157',
'82157H',
'82158',
'82158H',
'82159',
'82159H',
'82160',
'82160H',
'82161',
'82162',
'82162H',
'82163',
'82163H',
'82164',
'82164H',
'82165',
'82165H',
'82166',
'82167',
'82168',
'82168H',
'82169',
'82169H',
'82170',
'82170H',
'82171',
'82171H',
'82172',
'82172H',
'82173',
'82173H',
'82174',
'82174H',
'82175',
'82175H',
'82176',
'82176H',
'82177',
'82178',
'82178H',
'82179',
'82180',
'82181',
'82181H',
'82187',
'82193X',
'82207',
'82210',
'82212',
'82213',
'87900',
'87901',
'87902',
'87903',
'87905',
'87906',
'87907',
'87910',
'87911',
'87912',
'87913',
'87914',
'87915',
'87916',
'87917',
'87918',
'88001',
'88003',
'88006',
'88011',
'88013',
'88210',
'88214',
'88216',
'88218',
'88219',
'K9329-004',
'K9329-006',
'K9329-008',
'K9329-10',
'K9329-10F',
'K9329-12',
'K9329-1216',
'K9329-14',
'K9329-1414',
'K9329-16',
'K9329-1614',
'K9329-3',
'K9329-332',
'K9329-4',
'K9329-428',
'K9329-5',
'K9329-524',
'K9329-6',
'K9329-624',
'K9329-7',
'K9329-720',
'K9329-8',
'K9329-820',
'K9329-9',
'K9329-918',
'K9450-10',
'K9450-12',
'K9450-16',
'K9450-3',
'K9450-4',
'K9450-5',
'K9450-6',
'K9450-8',
'K9650-10',
'K9650-10F',
'K9650-12',
'K9650-14',
'K9650-16',
'K9650-6',
'K9650-8',
'K9450-20',
'69116',
'69114',
'69113',
'68916',
'68914',
'68913',
'68116',
'68114',
'68113',
'82324',
'82195X',
'82214',
'82215',
'82216',
'82218',
'8751-10',
'8751-12',
'8755-10',
'8755-8',
'8756-10',
'8756-12',
'38751-2.5-15',
'38751-3-15',
'38751-4-15',
'38751-5-15',
'38751-6-15',
'8050-400C',
'8252-8',
'67700',
'67701',
'67702',
'67703',
'67704',
'67705',
'67706',
'67707',
'67708',
'67709',
'67710',
'67711',
'67712M',
'67713',
'67713M',
'67714',
'67714M',
'67715M',
'67716',
'67716M',
'67717M',
'67718M',
'67719M',
'67721',
'67722',
'67723',
'67724',
'67725',
'67726',
'67731',
'67732',
'67733',
'67734',
'67735',
'67736',
'67737',
'67738',
'67739',
'67740',
'67741',
'H115-4EG',
'H115-4SS316',
'H115-1-1/2EG',
'H115-1-1/4EG',
'H115-1/2EG',
'H115-1/2SS6',
'H115-2-1/2EG',
'H115-3/4EG',
'H115-1-1/4SS6C',
'H115-2SS6C',
'H115-4SS6C',
'H115-6EG',
'H115-1-1/2SS6',
'H115-3/4SS6',
'H115-12INCH-B',
'H115-6B',
'H115-3SS316',
'HL-115-1-1/4',
'HL-115-1/2',
'HL-115-1-1/2',
'HL-115-5',
'H115-5',
'H115-6',
'H115-10EG',
'H115-8EG',
'H115-1',
'H115-1-1/2',
'H115-1-1/2B',
'H115-1/2',
'H115-10',
'H115-2',
'H115-2-1/2',
'H115-2B',
'H115-3',
'H115-3-1/2',
'H115-3/4',
'H115-4',
'H115-1-1/4',
'H115-10B',
'FIG 137SSG',
'FIG 137SS',
'FIG 137S',
'FIG 137N',
'FIG 137C',
'FIG 137',
'FIG 120',
'UB8PANH6',
'UB8PANH',
'UB8PAN6',
'UB8PAN',
'UB7/8TANH6',
'UB7/8TANH',
'UB7/8TAN6',
'UB7/8TAN',
'UB7/8TA6',
'UB6TA6',
'UB6TA',
'UB6PANH6',
'UB6PANH',
'UB6PAN6',
'UB6PAN',
'UB5TA6',
'UB5TA',
'UB5PANH6',
'UB5PANH',
'UB5PAN6',
'UB5PAN',
'UB4TA6',
'UB4TA',
'UB4PANH6',
'UB4PANH',
'UB4PAN6',
'UB4PAN',
'UB3TA6',
'UB3TA',
'UB3PANH6',
'UB3PANH',
'UB3PAN6',
'UB3PAN',
'UB31/2PANH6',
'UB31/2PANH',
'UB31/2PAN6',
'UB3-1/2PAN',
'UB3/4PANH6',
'UB3/4PANH',
'UB3/4PAN6',
'UB3/4PAN',
'UB2TA6',
'UB2TA',
'UB2PANH6',
'UB2PANH',
'UB2PAN6',
'UB2PAN',
'UB2-1/2PANH6',
'UB2-1/2PANH',
'UB2-1/2PAN6',
'UB2-1/2PAN',
'UB1TANH6',
'UB1TANH',
'UB1TAN6',
'UB1TAN',
'UB1TA6',
'UB1PANH6',
'UB1PANH',
'UB1PAN6',
'UB1PAN',
'UB1-3/8TANH6',
'UB1-3/8TANH',
'UB1-3/8TAN6',
'UB1-3/8TAN',
'UB1-3/8TA6',
'UB12PANH6',
'UB12PANH',
'UB12PAN6',
'UB12PAN',
'UB12PA6',
'UB12PA',
'UB1-1/4TANH6',
'UB1-1/4TANH',
'UB1-1/4TAN6',
'UB1-1/4TAN',
'UB1-1/4TA6',
'UB1-1/4PANH6',
'UB1-1/4PANH',
'UB1-1/4PAN6',
'UB1-1/4PAN',
'UB1-1/2PANH6',
'UB1-1/2PANH',
'UB1-1/2PAN6',
'UB1-1/2PAN',
'UB10PANH6',
'UB10PANH',
'67742',
'UB10PAN6',
'UB10PAN',
'UB10PA6',
'UB10PA',
'UB1/2PANH6',
'UB1/2PANH',
'UB1/2PAN6',
'UB1/2PAN',
'HTUB8PA6',
'HTUB8PA',
'HTUB78TA6',
'HTUB78TA',
'HTUB6TA6',
'HTUB6TA',
'HTUB6PA6',
'HTUB6PA',
'HTUB5TA6',
'HTUB5TA',
'HTUB5PA6',
'HTUB5PA',
'HTUB4TA6',
'HTUB4TA',
'HTUB4PA6',
'HTUB4PA',
'HTUB3TA6',
'HTUB3TA',
'HTUB3PA6',
'HTUB3PA',
'HTUB34PA6',
'HTUB34PA',
'HTUB312PA6',
'HTUB312PA',
'HTUB2TA6',
'67743',
'67751',
'67752',
'HTUB2TA',
'HTUB2PA6',
'67753',
'67755',
'67756',
'67763',
'67764',
'67765',
'67766',
'67767',
'67769',
'67770',
'67771',
'67773',
'67775',
'67801',
'67802',
'67803',
'67804',
'67805',
'67806',
'67807',
'67808',
'67809',
'67810',
'67811',
'67812',
'67813',
'67814',
'67816',
'67821',
'67822',
'67823',
'67824',
'67825',
'67826',
'67833',
'67834',
'67835',
'67836',
'67837',
'67838',
'67839',
'67840',
'67841',
'67842',
'67843',
'67853',
'67855',
'67856',
'67866',
'67867',
'67869',
'67870',
'67871',
'67872',
'67873',
'67874',
'67875',
'87000',
'87004',
'87006',
'87008',
'87010',
'87012',
'87016',
'87018',
'87019',
'87020',
'87021',
'87024S',
'87027',
'87029',
'87031',
'87032',
'87035',
'87040',
'87043',
'87044',
'87047',
'87048',
'87049',
'87210T',
'87212T',
'87214T',
'87216T',
'87218T',
'87219T',
'87303',
'87305',
'87307',
'87309',
'87310',
'87311',
'87312',
'87313',
'87314',
'87315',
'87316',
'87317',
'87318',
'87319',
'87320',
'87500T',
'87502T',
'87503T',
'87504T',
'87505T',
'87506T',
'87508T',
'87509T',
'87510T',
'87511T',
'87512T',
'87513T',
'87514T',
'87516T',
'87517T',
'87518T',
'87519T',
'87520T',
'87521T',
'87522T',
'87523T',
'87524T',
'87527S',
'87528S',
'87529S',
'87530S',
'87531S',
'87532S',
'87533S',
'87534S',
'87535S',
'87536S',
'87537S',
'87539S',
'87541S',
'87543S',
'87545S',
'87546S',
'87550T',
'87551T',
'87552T',
'87553T',
'87554T',
'87555T',
'87556T',
'87557T',
'87558T',
'87559T',
'87560T',
'87561T',
'87563T',
'87564T',
'87565T',
'87569T',
'87570T',
'87571T',
'87576S',
'87577S',
'87578S',
'87579S',
'87580S',
'87581S',
'87582S',
'87583S',
'87584S',
'87585S',
'87586S',
'87587S',
'88463-A1',
'88463-A2',
'TBA-02A',
'TBA-04A',
'TBA-06A',
'TBA-08A',
'TBA-1A',
'TBA-2.5A',
'TBA-4A',
'TBA-5A',
'TBA-6A',
'TBA-7A',
'TBA-8A',
'87050',
'87024B',
'87024T',
'87016T',
'87012T',
'87014T',
'87035T',
'87000T',
'87031T',
'87020T',
'87004T',
'87018T',
'87029T',
'87006T',
'87008T',
'87022T',
'87033T',
'87010T',
'87027T',
'87526TP',
'87517TP',
'87513TP',
'87532TP',
'87521TP',
'87519TP',
'87530TP',
'87523TP',
'87528TP',
'87563TP']
     for x in range(781,1200):
         print(x)
         print(list[x])
         get_details(url)

#652
#632
#656
#657